## Что тестируем

В этом тесте сравнивается производительность streaming json dumper c альтернативами:
- json из стандартной библиотеки Python (лишний раз убедиться, что он всё ещё очень медленный);
- ultrajson (он же ujson) - на текущий момент самый быстрый универсальный json-сериализатор для Python в Аркадии.

Тест позволяет проверить, сохраняет ли streaming json dumper своё лидерство в классе. Для этого граф загружается в память, и затем сериализуется в `/dev/null`. Отсутствие взаимодействие с диском улучшает повторяемость результатов и показывает максимально доступный для дампера результат.


## Как получить граф для теста (на случай, если текущий перестанет устраивать)

В продакшн графогенерация не сохраняет исходный сборочный граф, а только разницу между графами.
Но есть два выхода из положения:
1. запустить графогенерацию для одной из партиций автосборки локально;
2. взять готовый граф из задач тестирования кешей ymake.

Первый вариант - долгий и нужно знать автосборочные опции запуска. Второй вариант проще и быстрее:
1. Открываем в Sandbox [список ресурсов](https://sandbox.yandex-team.ru/resources?owner=AUTOCHECK_CACHE_TESTS&state=%2CREADY&type=AUTOCHECK_LOGS&limit=20&offset=0&created=7_days), который генерируется тестами.
1. Выбираем ресурс подходящего размера (от 400 Мбайт и больше).
1. Скачиваем выбранный ресурс:
    ```
    ya download sbr:...
    ```
1. Распаковываем из него `subtract_on_dist.tar`:
    ```
    tar xf subtract_on_dist.tar
    ```
1. В распакованном каталоге находим файл `subtract_on_dist/execute/subtract/left/graph.json.uc` - это полный сборочный граф.
1. В архивировании графов приоритет отдан скорости, поэтому степень сжатия невысокая. Чтобы сэкономить место и, главное, время на скачивание ресурса в тесте, его нужно перепаковать:
    ```
    ya tool uc -d -f subtract_on_dist/execute/subtract/left/graph.json.uc | ya tool uc -c -C zstd_9 -t graph.json.uc
    ```
    Тест рассчитан на фиксированное имя `graph.json.uc`, поэтому целевое имя файла лучше не менять, чтобы не переписывать тест.
1. Полученный файл заливаем в sandbox:
    ```
    ya upload --owner YATOOL --ttl inf graph.json.uc
    ```
1. Исправляем в ya.make id ресурса.
