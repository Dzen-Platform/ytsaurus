---
vcsPath: yql/docs_yfm/docs/ru/yql-product/faq/fts.md
sourcePath: yql-product/faq/fts.md
---
# Полнотекстовый поиск запросов и операций

## Почему мои операции / запросы не находятся? Строка явно содержится в них.
Поиск не работает по подстрокам. Поиск выполняется по словам или фразам.


## Где происходит поиск слов?
Система индексирует содержимое запроса (включая комментарии внутри), его заголовок и тэги, заголовок операции, содержимое прикрепленных файлов. Из содержимого запроса и файлов берётся лишь несколько начальных килобайт.


## Поддерживаете ли вы словоформы?
В некотором смысле - да. Поиск в mongodb базируется на стемминге, то есть на вычленении основы слова (лемматизация не поддерживается, увы).
Если в запросе есть слово **dog**, то его можно найти по запросу **dogs**. Но не удастся найти по слову **человек** текст, в котором содержится слово **люди**.

Примеры поиска основ:

* для слова **стульями** будет найдена основа **стул**;
* для слова **crying** будет найдена основа **cry**.


## Какие языки поддерживаются?
На данный момент поддерживается два языка: русский и английский. Если запрос на русском языке, то поиск происходит в русском индексе. Иначе - в английском.

Если в запросе есть и русские и английские слова, то

* для операций поиск осуществляется в русском индексе;
* для запросов поиск производится в обоих индексах после чего результаты объединяются.


## Как найти два слова сразу?
Если в поисковом запросе указано несколько слов, то найденные документы будут содержать хотя бы одно из указанных слов, но не обязательно все сразу. То есть происходит логическое **OR** объединение.
Выполнить объединение по **AND** не удастся, но есть возможность поискать фразу по точному совпадению, заключив её в двойные кавычки.


## Как убрать из выдачи неинтересные находки?
Если вы пытаетесь найти операции по одним словам, но выдачу заполняют неинтересные вам операции, то можно воспользоваться словами-исключениями. Перед такими словами необходимо поставить знак - (минус) и тогда из выдачи будут удалены те документы, которые содержат слова-исключения.
{% note warning "Важно!" %}

Важно: между минусом и словом не должно быть пробелов.

{% endnote %}


## Не находится простое слово in, оно точно есть.
Некоторые слова исключены из индекса. Они называются stop words. Это простые короткие слова: предлоги, местоимения и тд. Они часто употребляются и их просто выбрасывают при построении индекса. Поиск по таким словам не имеет смысла, старайтесь задавать уникальное слово в запросе.<br>

Списки слов:

* для [русского языка](https://github.com/mongodb/mongo/blob/master/src/mongo/db/fts/stop_words_russian.txt);
* для [английского языка](https://github.com/mongodb/mongo/blob/master/src/mongo/db/fts/stop_words_english.txt).


## Подчеркивание делит на слова?
Нет, подчеркивание не является разделителем слов. <br>Разделители слов - это пробелы, скобки, слеши, кавычки и тд.: , `, !, @, #, $, %, ^, &, *, (, ), -, =, +, [, ], {, }, |, \, ;, :, ", <, >, ,(запятая), .(точка), /, ?.<br>Апостроф является разделителем только в русском языке, а в английском является частью слова.


## Возникает ошибка при поиске: Failed loading search results.
Поиск требователен к ресурсам и в системе выставлен некоторый таймаут на выполнение поиска в базе. Таймаут необходим чтобы нагрузка не повлияла на стабильность и отклик системы.
Чтобы избавиться от ошибки, необходимо либо перезапустить запрос, либо переделать его так, чтобы запрос зацепился за наиболее редкое слово, используемое в текстах запросов (это уменьшит объем сканирования).
Также сервер требует больше ресурсов при поиске полных фраз или при использовании слов-исключений.


# Примеры
| Текст                                                            | Поисковый запрос | Найдено? |
|------------------------------------------------------------------| --- | --- |
| select * from my_table;                                          | from | <span style="color: red;"> нет </span> |
| select * from my_table;                                          | table | <span style="color: red;"> нет </span> |
| select * from my_table;                                          | my_table | <span style="color: green;"> да </span> |
| select * from my_table;                                          | my_tables | <span style="color: green;"> да </span> |
| select * from my_table;                                          | SELECT | <span style="color: green;"> да </span> |
| select * from my_table;                                          | Selection | <span style="color: green;"> да </span> |
| flatten my list;                                                 | flatten by | <span style="color: green;"> да </span> |
| flatten my list;                                                 | "flatten by" | <span style="color: red;"> нет </span> |
| pragma file("a.sql", "https://<cluster-name>/#page=navigation"); | cluster-name | <span style="color: green;"> да </span> |
