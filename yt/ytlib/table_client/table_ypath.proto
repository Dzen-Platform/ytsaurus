package NYT.NTableClient.NProto;

import "yt/core/misc/guid.proto";
import "yt/ytlib/node_tracker_client/node.proto";
import "yt/ytlib/new_table_client/chunk_meta.proto";
import "yt/ytlib/table_client/table_chunk_meta.proto";

////////////////////////////////////////////////////////////////////////////////

// Raises "sorted" flag for the root chunk list of the table.
// No checks are performed, it's caller's responsibility to ensure proper row order.
message TReqSetSorted
{
    repeated string key_columns = 1;
}

message TRspSetSorted
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqMount
{
    // If omitted then all tablets are affected.
    required int32 first_tablet_index = 1 [default = -1];
    required int32 last_tablet_index = 2 [default = -1];

    // If omitted then cell is chosen automatically.
    optional NYT.NProto.TGuid cell_id = 3;
}

message TRspMount
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqUnmount
{
    // If omitted then all tablets are affected.
    required int32 first_tablet_index = 1 [default = -1];
    required int32 last_tablet_index = 2 [default = -1];
    required bool force = 3 [default = false];
}

message TRspUnmount
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqRemount
{
    // If omitted then all tablets are affected.
    required int32 first_tablet_index = 1 [default = -1];
    required int32 last_tablet_index = 2 [default = -1];
}

message TRspRemount
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqReshard
{
    // If omitted then all tablets are affected.
    required int32 first_tablet_index = 1 [default = -1];
    required int32 last_tablet_index = 2 [default = -1];
    repeated bytes pivot_keys = 3;
}

message TRspReshard
{ }

////////////////////////////////////////////////////////////////////////////////

message TReqGetMountInfo
{ }

message TTabletInfo
{
    required NYT.NProto.TGuid tablet_id = 1;
    required int32 state = 2;
    required bytes pivot_key = 3;
    optional int32 cell_config_version = 4;
    optional bytes cell_config = 5; // NElection::TCellConfig
    repeated int32 replica_node_ids = 6;
}

message TRspGetMountInfo
{
    required NYT.NProto.TGuid table_id = 1;
    required NYT.NVersionedTableClient.NProto.TTableSchemaExt schema = 2;
    required NYT.NTableClient.NProto.TKeyColumnsExt key_columns = 3;
    repeated TTabletInfo tablets = 4;
    required bool sorted = 5;
    required NYT.NNodeTrackerClient.NProto.TNodeDirectory node_directory = 6;
}

////////////////////////////////////////////////////////////////////////////////
