2020-09-19 19:03:29,901  I  infer_partitioned_table:95  Processing scale 1d
2020-09-19 19:03:31,618  I  infer_partitioned_table:93  Scale 30min does not exist
2020-09-19 19:03:31,622  I  infer_partitioned_table:240  There are 3 distinct schemas
2020-09-19 19:03:31,622  D  infer_partitioned_table:242  Schema: {'value': [{'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': '_logfeller_index_bucket'}, {'type_v3': 'uint64', 'type': 'uint64', 'required': true, 'type_v2': 'uint64', 'name': '_logfeller_timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': '_rest'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': '_stbx'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__depth'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__elapsed'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__id'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__name'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__peak'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ntid'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__rk'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__root'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__sponsor'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__type'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__vw'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__wb'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': 'iso_eventtime'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'k'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'pid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'req'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sess'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sev'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'site'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': 'source_uri'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'tid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ts'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'user'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__cache-outcome'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'v__device-pixel-ratio'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__render-maps-client-side'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__action-result-size-bytes'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-type'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__annotation-count'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__client-render-mode'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-pixel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__encoding-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__filterfield-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__height'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__is-dashboard'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__mark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__marklabel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': 'v__request-info__metrics'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__node-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-views'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-zones'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__pane-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__refline-count'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__repository-url'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__rid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__session-state'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__sheetname'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__textmark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__tooltip-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__transparent-linemark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__vertex-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__width'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sitename'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__user-agent'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__username'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__workbook-name'}], 'attributes': {'strict': true, 'unique_keys': false}}
2020-09-19 19:03:31,623  D  infer_partitioned_table:242  Schema: {'value': [{'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': '_logfeller_index_bucket'}, {'type_v3': 'uint64', 'type': 'uint64', 'required': true, 'type_v2': 'uint64', 'name': '_logfeller_timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': '_rest'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': '_stbx'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__depth'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__elapsed'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__id'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__name'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__peak'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ntid'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__rk'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__root'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__sponsor'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__type'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__vw'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__wb'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': 'iso_eventtime'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'k'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'pid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'req'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sess'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sev'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'site'}, {'type_v3': 'string', 'type': 'string', 'required': true, 'type_v2': 'string', 'name': 'source_uri'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'tid'}, {'type_v3': 'uint64', 'type': 'uint64', 'required': true, 'type_v2': 'uint64', 'name': 'timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ts'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'user'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__cache-outcome'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'v__device-pixel-ratio'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__render-maps-client-side'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__action-result-size-bytes'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-type'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__annotation-count'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__client-render-mode'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-pixel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__encoding-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__filterfield-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__height'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__is-dashboard'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__mark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__marklabel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': 'v__request-info__metrics'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__node-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-views'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-zones'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__pane-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__refline-count'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__repository-url'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__rid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__session-state'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__sheetname'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__textmark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__tooltip-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__transparent-linemark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__vertex-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__width'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sitename'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__user-agent'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__username'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__workbook-name'}], 'attributes': {'strict': true, 'unique_keys': false}}
2020-09-19 19:03:31,623  D  infer_partitioned_table:242  Schema: {'value': [{'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': '_logfeller_index_bucket'}, {'type_v3': {'type_name': 'optional', 'item': 'uint64'}, 'type': 'uint64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'uint64'}, 'name': '_logfeller_timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': '_rest'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': '_stbx'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__depth'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__elapsed'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__id'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__name'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__alloc__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__alloc__peak'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__e'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'a__res__free__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ne'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__free__ni'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__kcpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ntid'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__e'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'a__res__ucpu__i'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__rk'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__root'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__sponsor'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'a__type'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__vw'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ctx__wb'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'iso_eventtime'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'k'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'pid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'req'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sess'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'sev'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'site'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'source_uri'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'tid'}, {'type_v3': {'type_name': 'optional', 'item': 'uint64'}, 'type': 'uint64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'uint64'}, 'name': 'timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'ts'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'user'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__cache-outcome'}, {'type_v3': {'type_name': 'optional', 'item': 'double'}, 'type': 'double', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'double'}, 'name': 'v__device-pixel-ratio'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__render-maps-client-side'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__action-result-size-bytes'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-timestamp'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__action-type'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__annotation-count'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__client-render-mode'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__customshape-pixel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__encoding-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__filterfield-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__height'}, {'type_v3': {'type_name': 'optional', 'item': 'bool'}, 'type': 'boolean', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'boolean'}, 'name': 'v__request-info__is-dashboard'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__mark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__marklabel-count'}, {'type_v3': {'type_name': 'optional', 'item': 'yson'}, 'type': 'any', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'any'}, 'name': 'v__request-info__metrics'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__node-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-views'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__num-zones'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__pane-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__refline-count'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__repository-url'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__rid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__session-state'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__request-info__sheetname'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__textmark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__tooltip-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__transparent-linemark-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__vertex-count'}, {'type_v3': {'type_name': 'optional', 'item': 'int64'}, 'type': 'int64', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'int64'}, 'name': 'v__request-info__width'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sid'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__sitename'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__user-agent'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__username'}, {'type_v3': {'type_name': 'optional', 'item': 'string'}, 'type': 'string', 'required': false, 'type_v2': {'metatype': 'optional', 'element': 'string'}, 'name': 'v__workbook-name'}], 'attributes': {'strict': true, 'unique_keys': false}}
Traceback (most recent call last):
  File "infer_partitioned_table.py", line 274, in <module>
    main()
  File "infer_partitioned_table.py", line 270, in main
    infer_common_schema(scale_to_partitions["1d"])
  File "infer_partitioned_table.py", line 253, in infer_common_schema
    schema = inferrer.flush_schema()
  File "infer_partitioned_table.py", line 226, in flush_schema
    schema = [state.flush_schema() for state in states]
  File "infer_partitioned_table.py", line 226, in <listcomp>
    schema = [state.flush_schema() for state in states]
  File "infer_partitioned_table.py", line 174, in flush_schema
    assert len(self.required_values) == 1
AssertionError
