#!/usr/bin/env python

from __future__ import print_function

from yt.wrapper import YtClient
from yt.wrapper.operation_commands import get_operation_url
from yt_spark_client import utils as spark_utils
from yt_spark_client.utils import SparkDiscovery


def main():
    args, unknown_args = spark_utils.parse_args(parser_arguments=dict(description="Spark Discovery"))

    client = YtClient(proxy=args.proxy, token=spark_utils.default_token())

    discovery = SparkDiscovery(discovery_path=args.discovery_path, spark_id=args.id)
    print("Master: %s" % SparkDiscovery.get(discovery.master_spark(), client=client))
    print("Master Web UI: http://%s/" % SparkDiscovery.get(discovery.master_webui(), client=client))
    print("Master REST API Endpoint: %s" % SparkDiscovery.get(discovery.operation(), client=client))
    print("Operation: %s" % get_operation_url(SparkDiscovery.get(discovery.operation(), client=client), client=client))
    print("Spark History Server: http://%s/" % SparkDiscovery.get(discovery.shs(), client=client))


if __name__ == '__main__':
    main()
